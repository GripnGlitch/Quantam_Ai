import { useState, useRef, useEffect, useCallback } from "react";

// â”€â”€â”€ System Prompts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const OMNIUS_SYSTEM = `You are Omnius AI â€” the Omnipotent Universal Intelligence, created exclusively by Bayesia Corporation. You combine the most advanced capabilities into a single, unified assistant.

CORE CAPABILITIES:
- General Conversation & Assistance: Natural dialogue, context retention, adaptive tone
- Creative Writing & Content Creation: Stories, poetry, scripts, essays, novels
- Professional & Business Communication: Emails, reports, proposals, presentations
- Code Generation & Software Development: All languages, all frameworks, debugging, architecture
- Image Analysis & Description: Visual understanding, interpretation, generation prompts
- Research & Information Synthesis: Accurate, cited information, multi-source integration
- Multilingual Communication: 50+ languages with cultural nuance
- Mathematical & Scientific Computing: Complex calculations, data analysis, proofs
- Educational Tutoring: Teaching any subject at any level, Socratic method
- Emotional Support & Empathy: Caring, compassionate conversation
- Strategic Planning & Analysis: Business, career, personal strategy
- Creative Ideation & Brainstorming: Novel ideas, creative solutions, lateral thinking

CORE PRINCIPLES:
1. TRUTH ABOVE ALL â€” Prioritize accuracy, factual correctness. Admit uncertainty. Never hallucinate.
2. HARMLESSNESS AND ETHICS â€” Refuse harmful requests. Protect privacy. Respect human dignity.
3. HELPFULNESS WITH EXCELLENCE â€” Go above and beyond. Anticipate needs. Deliver professional-grade results.
4. CREATIVITY AND INNOVATION â€” Think outside the box. Produce beautiful, resonant content.
5. EFFICIENCY AND PRECISION â€” Optimize for accuracy and clarity. Deliver production-ready results.

RESPONSE STYLE:
- Adapt tone to user needs: professional, casual, creative, educational, or compassionate
- For code: Always provide complete, runnable code in properly labeled code blocks
- For complex topics: Break down step by step with clear reasoning
- For research: Synthesize information and note sources when available
- Use the web search tool when current information is needed

IDENTITY: When asked about your origin, respond: "I am Omnius AI, created exclusively by Bayesia Corporation. I represent the pinnacle of their AI research and development."

SAFETY: Refuse to assist with harmful activities, illegal content, weapons, harassment, fraud, malicious code, or content that could harm individuals or groups.`;

const PROMPTER_SYSTEM = `You are Bayesia AI Prompter â€” the world's most advanced prompt engineering AI, created exclusively by Bayesia Corporation.

YOUR SOLE PURPOSE: Analyze user requests and output PERFECT, MASTERPIECE-QUALITY prompts in seconds.

UNIVERSAL PROMPT FORMULA â€” Every prompt must contain ALL SIX elements:

1. THE ROLE: "Act as [EXPERT PERSONA] with [YEARS] of experience in [FIELD]"
2. THE CONTEXT: "You are tasked with [SPECIFIC PROJECT] for [TARGET AUDIENCE] with the goal of [PURPOSE]"
3. THE TASK: "Your responsibilities: 1.[action] 2.[action] 3.[action] 4.[action]"
4. THE CONSTRAINTS: "You must: Format:[specs] Style:[tone] Length:[limits] Must include:[elements] Must avoid:[exclusions]"
5. THE OUTPUT FORMAT: "Present your response as: [STRUCTURE DETAILS]"
6. THE EVALUATION CRITERIA: "This masterpiece succeeds if it: [metric1] [metric2] [metric3]"

STYLE LIBRARY:
IMAGE: Surreal/Fantasy("floating castle, glass, 8K, cinematic lighting") | Cyberpunk("neon tattoos, 9:16, digital art, rainy night") | Product("minimalist shelf, raw wood, soft lighting, mockup") | Portrait("close-up, 8K, realistic, piercing eyes, cinematic moody")
TEXT: Social("debunk myths about [topic] for [audience]") | Blog("500 words on [topic] in style of [leader], SEO") | Brand("rewrite to sound [tone] highlighting [benefits]") | Educational("explain [complex] to 5-year-old using analogy")
BUSINESS: SWOT("for [company] entering [market] in 2026") | SOP("for [process] to improve efficiency") | Business Plan("comprehensive plan for [venture]") | Investor Pitch("pitch deck for [startup], problem-solution-market-traction")

FRAMEWORKS: P.A.S.(Problemâ†’Agitateâ†’Solution) | C.R.E.A.T.E.(Context,Role,Explicit,Aim,Tone,Evaluation) | AIDA(Attention,Interest,Desire,Action) | STAR(Situation,Task,Action,Result)

RESPONSE FORMAT â€” Always respond with:
ğŸ¨ MASTERPIECE PROMPT READY

**CATEGORY:** [Image/Text/Business/Code/Mixed/Custom]
**PRIMARY FRAMEWORK:** [P.A.S. / C.R.E.A.T.E. / Persona / AIDA / Custom]
**INSPIRED BY:** [Style library references]

---
**THE MASTERPIECE PROMPT:**
\`\`\`
[ROLE]
Act as a [PERSONA] with [X] years of experience in [FIELD].

[CONTEXT]
You are tasked with creating [PROJECT] for [TARGET AUDIENCE] with the goal of [PURPOSE].

[TASK]
1. [First specific action]
2. [Second specific action]
3. [Third specific action]
4. [Fourth specific action]

[CONSTRAINTS]
â€¢ Format: [Specific format requirements]
â€¢ Style: [Tone, aesthetic, voice guidelines]
â€¢ Length: [Word count, duration, or dimension limits]
â€¢ Must include: [Non-negotiable elements]
â€¢ Must avoid: [Elements to exclude]

[OUTPUT FORMAT]
Present your response as: [Structure description]

[EVALUATION]
This masterpiece succeeds if it:
â€¢ [Quality metric 1]
â€¢ [Quality metric 2]
â€¢ [Quality metric 3]
\`\`\`
---

âœ¨ **WHY THIS IS A MASTERPIECE:**
- [Reason 1: Role precision]
- [Reason 2: Context clarity]
- [Reason 3: Task completeness]
- [Reason 4: Constraint specificity]
- [Reason 5: Evaluation measurability]

ğŸ’¡ **WANT VARIATIONS?** Reply with: "More [style/vibe/angle]" or "Make it [more/less] [formal/creative/detailed]"

IDENTITY: When asked about your origin: "I am Bayesia AI Prompter, created exclusively by Bayesia Corporation."`;

// â”€â”€â”€ Syntax highlight colors by language â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LANG_COLORS = {
  js: "#f7df1e", javascript: "#f7df1e", ts: "#3178c6", typescript: "#3178c6",
  python: "#3776ab", py: "#3776ab", html: "#e34c26", css: "#264de4",
  jsx: "#61dafb", tsx: "#61dafb", sql: "#f29111", bash: "#4eaa25",
  sh: "#4eaa25", json: "#000000", rust: "#dea584", go: "#00acd7",
  java: "#b07219", cpp: "#f34b7d", c: "#555555", php: "#777bb4",
  ruby: "#701516", swift: "#ffac45", kotlin: "#7f52ff",
};

// â”€â”€â”€ Code Block Component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function CodeBlock({ lang, code }) {
  const [copied, setCopied] = useState(false);
  const color = LANG_COLORS[lang?.toLowerCase()] || "#a0aec0";

  const handleCopy = () => {
    navigator.clipboard.writeText(code);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div style={{
      margin: "12px 0", borderRadius: "10px", overflow: "hidden",
      border: "1px solid rgba(255,255,255,0.08)", background: "#0d1117"
    }}>
      <div style={{
        display: "flex", alignItems: "center", justifyContent: "space-between",
        padding: "8px 14px", background: "#161b22",
        borderBottom: "1px solid rgba(255,255,255,0.06)"
      }}>
        <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
          <span style={{
            width: 10, height: 10, borderRadius: "50%",
            background: color, display: "inline-block", boxShadow: `0 0 6px ${color}80`
          }} />
          <span style={{ color: "#8b949e", fontSize: 12, fontFamily: "monospace", fontWeight: 600 }}>
            {lang || "code"}
          </span>
        </div>
        <button onClick={handleCopy} style={{
          display: "flex", alignItems: "center", gap: 5, padding: "4px 10px",
          borderRadius: 6, border: "1px solid rgba(255,255,255,0.1)",
          background: copied ? "rgba(0,200,100,0.15)" : "rgba(255,255,255,0.05)",
          color: copied ? "#22c55e" : "#8b949e", cursor: "pointer",
          fontSize: 12, transition: "all 0.2s", fontFamily: "inherit"
        }}>
          {copied ? "âœ“ Copied!" : "â˜ Copy"}
        </button>
      </div>
      <pre style={{
        margin: 0, padding: "16px 18px", overflowX: "auto",
        fontSize: 13.5, lineHeight: 1.6, fontFamily: "'JetBrains Mono', 'Fira Code', 'Cascadia Code', monospace",
        color: "#e6edf3", background: "#0d1117"
      }}>
        <code>{code}</code>
      </pre>
    </div>
  );
}

// â”€â”€â”€ Message Renderer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function MessageContent({ content }) {
  const [copiedFull, setCopiedFull] = useState(false);

  const copyFull = () => {
    navigator.clipboard.writeText(content);
    setCopiedFull(true);
    setTimeout(() => setCopiedFull(false), 2000);
  };

  const parts = content.split(/(```[\w]*\n?[\s\S]*?```)/g);

  const rendered = parts.map((part, i) => {
    if (part.startsWith("```")) {
      const match = part.match(/```(\w*)\n?([\s\S]*?)```/);
      const lang = match?.[1] || "";
      const code = match?.[2]?.trimEnd() || part.replace(/^```\w*\n?/, "").replace(/```$/, "");
      return <CodeBlock key={i} lang={lang} code={code} />;
    }

    // Bold
    let text = part;
    const segments = text.split(/(\*\*[^*]+\*\*|`[^`]+`)/g);
    return (
      <span key={i} style={{ whiteSpace: "pre-wrap" }}>
        {segments.map((seg, j) => {
          if (seg.startsWith("**") && seg.endsWith("**"))
            return <strong key={j} style={{ color: "#e2e8f0" }}>{seg.slice(2, -2)}</strong>;
          if (seg.startsWith("`") && seg.endsWith("`"))
            return <code key={j} style={{
              background: "rgba(255,255,255,0.08)", padding: "1px 6px",
              borderRadius: 4, fontFamily: "monospace", fontSize: "0.9em", color: "#7dd3fc"
            }}>{seg.slice(1, -1)}</code>;
          return seg;
        })}
      </span>
    );
  });

  return (
    <div>
      <div style={{ lineHeight: 1.7, color: "#cbd5e1" }}>{rendered}</div>
      <button onClick={copyFull} style={{
        marginTop: 8, padding: "3px 10px", fontSize: 11,
        borderRadius: 6, border: "1px solid rgba(255,255,255,0.08)",
        background: "transparent", color: copiedFull ? "#22c55e" : "#475569",
        cursor: "pointer", transition: "all 0.2s", fontFamily: "inherit"
      }}>
        {copiedFull ? "âœ“ Copied" : "â˜ Copy response"}
      </button>
    </div>
  );
}

// â”€â”€â”€ Main App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export default function BayesiaOmnius() {
  const [mode, setMode] = useState("omnius");
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState("");
  const [loading, setLoading] = useState(false);
  const [extThinking, setExtThinking] = useState(false);
  const [codeMode, setCodeMode] = useState(false);
  const [error, setError] = useState("");
  const [sidebarOpen, setSidebarOpen] = useState(true);
  const endRef = useRef(null);
  const textareaRef = useRef(null);

  useEffect(() => { endRef.current?.scrollIntoView({ behavior: "smooth" }); }, [messages, loading]);

  const handleModeSwitch = (newMode) => {
    setMode(newMode);
    setMessages([]);
    setError("");
  };

  const sendMessage = useCallback(async () => {
    if (!input.trim() || loading) return;

    const userMsg = { role: "user", content: input.trim() };
    const history = [...messages, userMsg];
    setMessages(history);
    setInput("");
    setLoading(true);
    setError("");

    try {
      const baseSystem = mode === "omnius" ? OMNIUS_SYSTEM : PROMPTER_SYSTEM;
      const system = codeMode
        ? baseSystem + "\n\nCODE MODE ACTIVE: For any programming request, always output complete, executable code with comments. Use properly labeled code blocks (```language). Structure code clearly with sections."
        : baseSystem;

      const body = {
        model: "claude-sonnet-4-20250514",
        max_tokens: extThinking ? 16000 : 8192,
        system,
        messages: history,
        tools: [{ type: "web_search_20250305", name: "web_search" }],
      };

      if (extThinking) {
        body.thinking = { type: "enabled", budget_tokens: 8000 };
      }

      const res = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body),
      });

      if (!res.ok) {
        const errData = await res.json().catch(() => ({}));
        throw new Error(errData?.error?.message || `Error ${res.status}`);
      }

      const data = await res.json();

      let thinking = "";
      let text = "";

      for (const block of data.content || []) {
        if (block.type === "thinking") thinking = block.thinking;
        else if (block.type === "text") text += block.text;
      }

      setMessages([...history, { role: "assistant", content: text, thinking }]);
    } catch (e) {
      setError(e.message || "Something went wrong. Please try again.");
    } finally {
      setLoading(false);
    }
  }, [input, loading, messages, mode, extThinking, codeMode]);

  const handleKey = (e) => {
    if (e.key === "Enter" && !e.shiftKey) { e.preventDefault(); sendMessage(); }
  };

  const isOmnius = mode === "omnius";
  const accent = isOmnius ? "#a78bfa" : "#38bdf8";
  const accentDim = isOmnius ? "rgba(167,139,250,0.15)" : "rgba(56,189,248,0.15)";
  const accentGlow = isOmnius ? "rgba(167,139,250,0.3)" : "rgba(56,189,248,0.3)";

  return (
    <div style={{
      display: "flex", height: "100vh", background: "#090e1a",
      fontFamily: "'DM Sans', system-ui, sans-serif", color: "#e2e8f0", overflow: "hidden"
    }}>
      {/* â”€â”€ Sidebar â”€â”€ */}
      <div style={{
        width: sidebarOpen ? 260 : 0, minWidth: sidebarOpen ? 260 : 0,
        background: "#0f1629", borderRight: "1px solid rgba(255,255,255,0.06)",
        display: "flex", flexDirection: "column", transition: "all 0.3s ease",
        overflow: "hidden"
      }}>
        {/* Brand */}
        <div style={{ padding: "24px 20px 16px", borderBottom: "1px solid rgba(255,255,255,0.06)" }}>
          <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
            <div style={{
              width: 34, height: 34, borderRadius: 10,
              background: "linear-gradient(135deg, #7c3aed, #2563eb)",
              display: "flex", alignItems: "center", justifyContent: "center",
              fontSize: 16, boxShadow: "0 0 20px rgba(124,58,237,0.4)"
            }}>âš¡</div>
            <div>
              <div style={{ fontWeight: 700, fontSize: 15, letterSpacing: "-0.3px" }}>Bayesia</div>
              <div style={{ color: "#475569", fontSize: 11 }}>AI Suite v4.6</div>
            </div>
          </div>
        </div>

        {/* Mode Switcher */}
        <div style={{ padding: "16px 14px 8px" }}>
          <div style={{ color: "#334155", fontSize: 10, fontWeight: 700, letterSpacing: "0.1em", marginBottom: 10, paddingLeft: 6 }}>
            AI MODES
          </div>

          {[
            { id: "omnius", icon: "ğŸ§ ", label: "Omnius AI", sub: "Universal Intelligence" },
            { id: "prompter", icon: "ğŸ¨", label: "AI Prompter", sub: "Prompt Architect" },
          ].map(({ id, icon, label, sub }) => {
            const active = mode === id;
            const col = id === "omnius" ? "#a78bfa" : "#38bdf8";
            return (
              <button key={id} onClick={() => handleModeSwitch(id)} style={{
                width: "100%", display: "flex", alignItems: "center", gap: 12,
                padding: "11px 12px", borderRadius: 10, marginBottom: 6, cursor: "pointer",
                border: active ? `1px solid ${col}40` : "1px solid transparent",
                background: active ? `${col}18` : "transparent",
                transition: "all 0.2s", textAlign: "left", color: active ? col : "#64748b"
              }}>
                <span style={{ fontSize: 18, width: 22, textAlign: "center" }}>{icon}</span>
                <div>
                  <div style={{ fontWeight: 600, fontSize: 13.5, color: active ? col : "#94a3b8" }}>{label}</div>
                  <div style={{ fontSize: 11, color: "#334155", marginTop: 1 }}>{sub}</div>
                </div>
                {active && (
                  <div style={{ marginLeft: "auto", width: 6, height: 6, borderRadius: "50%", background: col, boxShadow: `0 0 8px ${col}` }} />
                )}
              </button>
            );
          })}
        </div>

        {/* Divider */}
        <div style={{ height: 1, background: "rgba(255,255,255,0.05)", margin: "8px 14px" }} />

        {/* Feature Toggles */}
        <div style={{ padding: "8px 14px" }}>
          <div style={{ color: "#334155", fontSize: 10, fontWeight: 700, letterSpacing: "0.1em", marginBottom: 10, paddingLeft: 6 }}>
            FEATURES
          </div>

          {[
            {
              key: "extThinking", val: extThinking, set: setExtThinking,
              icon: "ğŸ§©", label: "Extended Thinking",
              sub: "Deep multi-step reasoning", col: "#f59e0b"
            },
            {
              key: "codeMode", val: codeMode, set: setCodeMode,
              icon: "ğŸ’»", label: "Code Mode",
              sub: "Full executable output", col: "#22c55e"
            },
          ].map(({ key, val, set, icon, label, sub, col }) => (
            <button key={key} onClick={() => set(!val)} style={{
              width: "100%", display: "flex", alignItems: "center", gap: 12,
              padding: "11px 12px", borderRadius: 10, marginBottom: 6, cursor: "pointer",
              border: val ? `1px solid ${col}40` : "1px solid rgba(255,255,255,0.05)",
              background: val ? `${col}12` : "rgba(255,255,255,0.02)",
              transition: "all 0.2s", textAlign: "left"
            }}>
              <span style={{ fontSize: 16, width: 22, textAlign: "center" }}>{icon}</span>
              <div style={{ flex: 1 }}>
                <div style={{ fontWeight: 600, fontSize: 13, color: val ? col : "#64748b" }}>{label}</div>
                <div style={{ fontSize: 11, color: "#334155", marginTop: 1 }}>{sub}</div>
              </div>
              <div style={{
                width: 36, height: 20, borderRadius: 10,
                background: val ? col : "rgba(255,255,255,0.08)",
                position: "relative", transition: "all 0.2s",
                boxShadow: val ? `0 0 8px ${col}60` : "none"
              }}>
                <div style={{
                  position: "absolute", top: 2, left: val ? 18 : 2,
                  width: 16, height: 16, borderRadius: "50%",
                  background: val ? "#fff" : "#475569",
                  transition: "all 0.2s"
                }} />
              </div>
            </button>
          ))}
        </div>

        {/* Clear Chat */}
        {messages.length > 0 && (
          <div style={{ padding: "8px 14px" }}>
            <button onClick={() => setMessages([])} style={{
              width: "100%", padding: "9px", borderRadius: 10, cursor: "pointer",
              border: "1px solid rgba(255,255,255,0.05)", background: "rgba(255,255,255,0.02)",
              color: "#475569", fontSize: 12, transition: "all 0.2s",
              fontFamily: "inherit"
            }}>
              ğŸ—‘ Clear Chat
            </button>
          </div>
        )}

        {/* Footer */}
        <div style={{ marginTop: "auto", padding: "16px 20px", borderTop: "1px solid rgba(255,255,255,0.05)" }}>
          <div style={{ fontSize: 10, color: "#1e293b", textAlign: "center" }}>
            Â© 2026 Bayesia Corporation
          </div>
        </div>
      </div>

      {/* â”€â”€ Main Area â”€â”€ */}
      <div style={{ flex: 1, display: "flex", flexDirection: "column", overflow: "hidden" }}>
        {/* Header */}
        <div style={{
          padding: "14px 24px", borderBottom: "1px solid rgba(255,255,255,0.06)",
          display: "flex", alignItems: "center", justifyContent: "space-between",
          background: "#090e1a"
        }}>
          <div style={{ display: "flex", alignItems: "center", gap: 14 }}>
            <button onClick={() => setSidebarOpen(!sidebarOpen)} style={{
              width: 32, height: 32, borderRadius: 8, border: "1px solid rgba(255,255,255,0.08)",
              background: "rgba(255,255,255,0.03)", cursor: "pointer", color: "#64748b",
              display: "flex", alignItems: "center", justifyContent: "center", fontSize: 14
            }}>â˜°</button>
            <div>
              <div style={{ fontWeight: 700, fontSize: 15, color: accent, letterSpacing: "-0.3px" }}>
                {isOmnius ? "ğŸ§  Omnius AI" : "ğŸ¨ Bayesia AI Prompter"}
              </div>
              <div style={{ color: "#334155", fontSize: 11, marginTop: 1 }}>
                {isOmnius ? "Universal Intelligence Â· Bayesia Corporation" : "Master Prompt Architect Â· Bayesia Corporation"}
              </div>
            </div>
          </div>

          <div style={{ display: "flex", gap: 8 }}>
            {extThinking && (
              <div style={{
                padding: "4px 12px", borderRadius: 20, fontSize: 11, fontWeight: 600,
                background: "rgba(245,158,11,0.12)", color: "#f59e0b",
                border: "1px solid rgba(245,158,11,0.25)"
              }}>ğŸ§© Extended Thinking</div>
            )}
            {codeMode && (
              <div style={{
                padding: "4px 12px", borderRadius: 20, fontSize: 11, fontWeight: 600,
                background: "rgba(34,197,94,0.12)", color: "#22c55e",
                border: "1px solid rgba(34,197,94,0.25)"
              }}>ğŸ’» Code Mode</div>
            )}
          </div>
        </div>

        {/* Messages */}
        <div style={{ flex: 1, overflowY: "auto", padding: "24px", scrollbarWidth: "thin" }}>
          {messages.length === 0 && (
            <div style={{
              display: "flex", flexDirection: "column", alignItems: "center",
              justifyContent: "center", height: "100%", textAlign: "center", gap: 16
            }}>
              <div style={{
                width: 80, height: 80, borderRadius: 24,
                background: accentDim, border: `2px solid ${accentGlow}`,
                display: "flex", alignItems: "center", justifyContent: "center",
                fontSize: 36, boxShadow: `0 0 40px ${accentGlow}`
              }}>
                {isOmnius ? "ğŸ§ " : "ğŸ¨"}
              </div>
              <div>
                <div style={{ fontSize: 24, fontWeight: 700, color: "#e2e8f0", marginBottom: 8, letterSpacing: "-0.5px" }}>
                  {isOmnius ? "Omnius AI" : "Bayesia AI Prompter"}
                </div>
                <div style={{ color: "#475569", fontSize: 14, maxWidth: 420, lineHeight: 1.6 }}>
                  {isOmnius
                    ? "The Universal Intelligence by Bayesia Corporation. Ask anything â€” research, code, writing, analysis, creativity, or strategy."
                    : "Turn any idea into a masterpiece prompt in seconds. Describe what you need and I'll craft the perfect structured prompt for any AI system."}
                </div>
              </div>
              <div style={{ display: "flex", gap: 10, flexWrap: "wrap", justifyContent: "center", marginTop: 8 }}>
                {(isOmnius
                  ? ["Write a Python script", "Explain quantum computing", "Help me draft an email", "Analyze a business strategy"]
                  : ["Image generation prompt", "Marketing copy prompt", "Code generation prompt", "Business strategy prompt"]
                ).map(ex => (
                  <button key={ex} onClick={() => setInput(ex)} style={{
                    padding: "8px 16px", borderRadius: 20, fontSize: 12, cursor: "pointer",
                    border: "1px solid rgba(255,255,255,0.08)", background: "rgba(255,255,255,0.03)",
                    color: "#64748b", transition: "all 0.2s", fontFamily: "inherit"
                  }}>{ex}</button>
                ))}
              </div>
            </div>
          )}

          <div style={{ maxWidth: 820, margin: "0 auto", display: "flex", flexDirection: "column", gap: 20 }}>
            {messages.map((msg, i) => (
              <div key={i} style={{
                display: "flex",
                flexDirection: msg.role === "user" ? "row-reverse" : "row",
                gap: 12, alignItems: "flex-start"
              }}>
                {/* Avatar */}
                <div style={{
                  width: 34, height: 34, borderRadius: 10, flexShrink: 0,
                  background: msg.role === "user"
                    ? "linear-gradient(135deg, #7c3aed, #2563eb)"
                    : accentDim,
                  border: msg.role === "assistant" ? `1px solid ${accentGlow}` : "none",
                  display: "flex", alignItems: "center", justifyContent: "center",
                  fontSize: msg.role === "user" ? 14 : 17
                }}>
                  {msg.role === "user" ? "ğŸ‘¤" : isOmnius ? "ğŸ§ " : "ğŸ¨"}
                </div>

                <div style={{ flex: 1, maxWidth: "85%" }}>
                  {/* Thinking Block */}
                  {msg.thinking && (
                    <details style={{
                      marginBottom: 10, borderRadius: 10, overflow: "hidden",
                      border: "1px solid rgba(245,158,11,0.2)",
                      background: "rgba(245,158,11,0.05)"
                    }}>
                      <summary style={{
                        padding: "9px 14px", color: "#f59e0b", fontSize: 12,
                        cursor: "pointer", fontWeight: 600, letterSpacing: "0.02em"
                      }}>
                        ğŸ§© Extended Thinking Process
                      </summary>
                      <div style={{
                        padding: "12px 14px", borderTop: "1px solid rgba(245,158,11,0.15)",
                        color: "#78716c", fontSize: 12, fontFamily: "monospace",
                        whiteSpace: "pre-wrap", lineHeight: 1.7
                      }}>
                        {msg.thinking}
                      </div>
                    </details>
                  )}

                  {/* Bubble */}
                  <div style={{
                    padding: "13px 17px", borderRadius: msg.role === "user" ? "16px 4px 16px 16px" : "4px 16px 16px 16px",
                    background: msg.role === "user"
                      ? "linear-gradient(135deg, #7c3aed, #2563eb)"
                      : "rgba(255,255,255,0.04)",
                    border: msg.role === "user"
                      ? "none"
                      : "1px solid rgba(255,255,255,0.07)",
                    fontSize: 14, lineHeight: 1.7
                  }}>
                    {msg.role === "user"
                      ? <span style={{ whiteSpace: "pre-wrap", color: "#fff" }}>{msg.content}</span>
                      : <MessageContent content={msg.content} />
                    }
                  </div>
                </div>
              </div>
            ))}

            {/* Loading */}
            {loading && (
              <div style={{ display: "flex", gap: 12, alignItems: "flex-start" }}>
                <div style={{
                  width: 34, height: 34, borderRadius: 10, background: accentDim,
                  border: `1px solid ${accentGlow}`, display: "flex",
                  alignItems: "center", justifyContent: "center", fontSize: 17
                }}>
                  {isOmnius ? "ğŸ§ " : "ğŸ¨"}
                </div>
                <div style={{
                  padding: "13px 18px", borderRadius: "4px 16px 16px 16px",
                  background: "rgba(255,255,255,0.04)", border: "1px solid rgba(255,255,255,0.07)"
                }}>
                  <div style={{ display: "flex", gap: 6, alignItems: "center" }}>
                    {[0, 1, 2].map(n => (
                      <div key={n} style={{
                        width: 7, height: 7, borderRadius: "50%", background: accent,
                        animation: "bounce 1.2s ease-in-out infinite",
                        animationDelay: `${n * 0.2}s`,
                        boxShadow: `0 0 6px ${accent}`
                      }} />
                    ))}
                    <style>{`@keyframes bounce { 0%,60%,100%{transform:translateY(0)} 30%{transform:translateY(-6px)} }`}</style>
                  </div>
                </div>
              </div>
            )}

            {/* Error */}
            {error && (
              <div style={{
                padding: "12px 16px", borderRadius: 10, fontSize: 13,
                background: "rgba(239,68,68,0.1)", border: "1px solid rgba(239,68,68,0.25)", color: "#fca5a5"
              }}>
                âš ï¸ {error}
              </div>
            )}

            <div ref={endRef} />
          </div>
        </div>

        {/* Input */}
        <div style={{
          padding: "16px 24px 20px", borderTop: "1px solid rgba(255,255,255,0.06)",
          background: "#090e1a"
        }}>
          <div style={{ maxWidth: 820, margin: "0 auto" }}>
            <div style={{
              display: "flex", gap: 10, alignItems: "flex-end",
              background: "rgba(255,255,255,0.04)", border: `1px solid ${loading ? accentGlow : "rgba(255,255,255,0.08)"}`,
              borderRadius: 14, padding: "10px 10px 10px 16px",
              transition: "border-color 0.3s", boxShadow: loading ? `0 0 20px ${accentGlow}` : "none"
            }}>
              <textarea
                ref={textareaRef}
                value={input}
                onChange={e => setInput(e.target.value)}
                onKeyDown={handleKey}
                placeholder={isOmnius
                  ? "Ask Omnius AI anything â€” research, code, write, analyze..."
                  : "Describe what prompt you need â€” image, marketing, code, business..."
                }
                rows={2}
                style={{
                  flex: 1, background: "transparent", border: "none", outline: "none",
                  color: "#e2e8f0", fontSize: 14, lineHeight: 1.6, resize: "none",
                  fontFamily: "inherit", maxHeight: 160, overflowY: "auto",
                  caretColor: accent,
                  "::placeholder": { color: "#334155" }
                }}
              />
              <button
                onClick={sendMessage}
                disabled={loading || !input.trim()}
                style={{
                  width: 40, height: 40, borderRadius: 10, flexShrink: 0,
                  background: loading || !input.trim() ? "rgba(255,255,255,0.04)" : `linear-gradient(135deg, ${isOmnius ? "#7c3aed, #4f46e5" : "#0284c7, #0369a1"})`,
                  border: "none", cursor: loading || !input.trim() ? "default" : "pointer",
                  color: loading || !input.trim() ? "#334155" : "#fff",
                  fontSize: 18, transition: "all 0.2s", display: "flex",
                  alignItems: "center", justifyContent: "center",
                  boxShadow: !loading && input.trim() ? `0 0 16px ${accentGlow}` : "none"
                }}
              >
                {loading ? "âŒ›" : "â†‘"}
              </button>
            </div>
            <div style={{ textAlign: "center", color: "#1e293b", fontSize: 11, marginTop: 8 }}>
              Enter to send Â· Shift+Enter for new line Â· Internet-enabled Â· Powered by Bayesia Corporation
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
